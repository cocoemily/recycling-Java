> library(betareg)
> library(tidyverse)
-- Attaching packages --------------------------------------- tidyverse 1.3.1 --
v ggplot2 3.3.5     v purrr   0.3.4
v tibble  3.1.2     v dplyr   1.0.7
v tidyr   1.1.3     v stringr 1.4.0
v readr   1.4.0     v forcats 0.5.1
-- Conflicts ------------------------------------------ tidyverse_conflicts() --
x dplyr::filter() masks stats::filter()
x dplyr::lag()    masks stats::lag()
> library(lmtest)
Loading required package: zoo

Attaching package: 'zoo'

The following objects are masked from 'package:base':

    as.Date, as.Date.numeric

> library(MASS)

Attaching package: 'MASS'

The following object is masked from 'package:dplyr':

    select

> library(gamlss)
Loading required package: splines
Loading required package: gamlss.data

Attaching package: 'gamlss.data'

The following object is masked from 'package:datasets':

    sleep

Loading required package: gamlss.dist
Loading required package: nlme

Attaching package: 'nlme'

The following object is masked from 'package:dplyr':

    collapse

Loading required package: parallel
 **********   GAMLSS Version 5.3-4  ********** 
For more on GAMLSS look at https://www.gamlss.com/
Type gamlssNews() to see new features/changes/bug fixes.

> 
> source("/scratch/ec3307/recycling-Java/analysis/ExtendedModel-analysis/sensitivity-analysis/betaselect.R")
> 
> alldata = read_csv("/scratch/ec3307/recycling-Java/output/joined_sensitivity-data.csv")

-- Column specification --------------------------------------------------------
cols(
  .default = col_double(),
  size_preference = col_logical(),
  flake_preference = col_logical(),
  strict_selection = col_logical()
)
i Use `spec()` for the full column specifications.

Warning: 1658850 parsing failures.
 row                col expected             actual                                                                file
3002 size               a double size               '/scratch/ec3307/recycling-Java/output/joined_sensitivity-data.csv'
3002 start_year         a double start_year         '/scratch/ec3307/recycling-Java/output/joined_sensitivity-data.csv'
3002 timestep           a double timestep           '/scratch/ec3307/recycling-Java/output/joined_sensitivity-data.csv'
3002 max_use_intensity  a double max_use_intensity  '/scratch/ec3307/recycling-Java/output/joined_sensitivity-data.csv'
3002 max_artifact_carry a double max_artifact_carry '/scratch/ec3307/recycling-Java/output/joined_sensitivity-data.csv'
.... .................. ........ .................. ...................................................................
See problems(...) for more details.

> 
> alldata = alldata %>% filter(size != "size") %>%
+   mutate(total.RI = as.numeric(total.RI), 
+          total.CR = as.numeric(total.CR)) %>%
+   group_by(max_use_intensity, max_artifact_carry, max_flake_size, max_nodules_size, blank_prob, scavenge_prob, overlap, mu, size_preference, flake_preference, min_suitable_flake_size, min_suitable_nodule_size, strict_selection) %>%
+   mutate(exp = cur_group_id()) %>%
+   filter(!is.na(total.RI))
> 
> u_alldata = alldata %>% mutate(s.total.RI = ifelse(total.RI == 0, (total.RI + 0.0001), total.RI)) %>% mutate(s.total.RI = ifelse(s.total.RI == 1, (s.total.RI - 0.0001), s.total.RI))
> 
> #full model
> #breg1 = betareg(s.total.RI ~ model_year + max_use_intensity  + max_artifact_carry + max_flake_size + max_nodules_size + blank_prob + scavenge_prob + factor(overlap) + mu + size_preference + flake_preference + min_suitable_flake_size + min_suitable_nodule_size + strict_selection , data=u_alldata)
> #AIC(breg1)
> 
> parameters = c("max_use_intensity", "max_artifact_carry", "max_flake_size","max_nodules_size", "blank_prob", "scavenge_prob", "overlap","mu", "size_preference", "flake_preference","min_suitable_flake_size", "min_suitable_nodule_size", "strict_selection")
> 
> #backwards stepwise regression
> 
> x = as.matrix(u_alldata[, parameters])
> y = as.matrix(u_alldata$s.total.RI)
> 
> step.model = betaselect(x, y, method = "backward")
slurmstepd: error: *** JOB 12754443 ON cl02 CANCELLED AT 2021-12-10T23:21:00 DUE TO TIME LIMIT ***
slurmstepd: error: *** JOB 12754443 STEPD TERMINATED ON cl02 AT 2021-12-10T23:22:00 DUE TO JOB NOT ENDING WITH SIGNALS ***
