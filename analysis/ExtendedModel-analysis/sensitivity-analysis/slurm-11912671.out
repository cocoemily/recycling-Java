> library(betareg)
> library(tidyverse)
-- Attaching packages --------------------------------------- tidyverse 1.3.1 --
v ggplot2 3.3.5     v purrr   0.3.4
v tibble  3.1.2     v dplyr   1.0.7
v tidyr   1.1.3     v stringr 1.4.0
v readr   1.4.0     v forcats 0.5.1
-- Conflicts ------------------------------------------ tidyverse_conflicts() --
x dplyr::filter() masks stats::filter()
x dplyr::lag()    masks stats::lag()
> library(lmtest)
Loading required package: zoo

Attaching package: 'zoo'

The following objects are masked from 'package:base':

    as.Date, as.Date.numeric

> 
> alldata = read_csv("/scratch/ec3307/recycling-Java/output/joined_sensitivity-data.csv")

-- Column specification --------------------------------------------------------
cols(
  .default = col_double(),
  size_preference = col_logical(),
  flake_preference = col_logical(),
  strict_selection = col_logical()
)
i Use `spec()` for the full column specifications.

Warning: 1658850 parsing failures.
 row                col expected             actual                                                                file
3002 size               a double size               '/scratch/ec3307/recycling-Java/output/joined_sensitivity-data.csv'
3002 start_year         a double start_year         '/scratch/ec3307/recycling-Java/output/joined_sensitivity-data.csv'
3002 timestep           a double timestep           '/scratch/ec3307/recycling-Java/output/joined_sensitivity-data.csv'
3002 max_use_intensity  a double max_use_intensity  '/scratch/ec3307/recycling-Java/output/joined_sensitivity-data.csv'
3002 max_artifact_carry a double max_artifact_carry '/scratch/ec3307/recycling-Java/output/joined_sensitivity-data.csv'
.... .................. ........ .................. ...................................................................
See problems(...) for more details.

> 
> alldata = alldata %>% filter(size != "size") %>%
+   mutate(total.RI = as.numeric(total.RI), 
+          total.CR = as.numeric(total.CR)) %>%
+   group_by(max_use_intensity, max_artifact_carry, max_flake_size, max_nodules_size, blank_prob, scavenge_prob, overlap, mu, size_preference, flake_preference, min_suitable_flake_size, min_suitable_nodule_size, strict_selection) %>%
+   mutate(exp = cur_group_id()) %>%
+   filter(!is.na(total.RI))
> 
> u_alldata = alldata %>% mutate(s.total.RI = ifelse(total.RI == 0, (total.RI + 0.0001), total.RI)) %>% mutate(s.total.RI = ifelse(s.total.RI == 1, (s.total.RI - 0.0001), s.total.RI))
> 
> #full model beta regression analysis
> breg1 = betareg(s.total.RI ~ model_year + max_use_intensity  + max_artifact_carry + max_flake_size + max_nodules_size + blank_prob + scavenge_prob + overlap + mu + size_preference + flake_preference + min_suitable_flake_size + min_suitable_nodule_size + strict_selection , data=u_alldata)
> coeftest(breg1)

z test of coefficients:

                            Estimate  Std. Error  z value  Pr(>|z|)    
(Intercept)              -1.1380e+00  6.9682e-04 -1633.13 < 2.2e-16 ***
model_year               -3.5980e-06  8.4012e-10 -4282.65 < 2.2e-16 ***
max_use_intensity         1.0737e-02  9.6124e-06  1117.03 < 2.2e-16 ***
max_artifact_carry       -1.2647e-02  1.4415e-05  -877.39 < 2.2e-16 ***
max_flake_size            9.6722e-02  1.4412e-04   671.12 < 2.2e-16 ***
max_nodules_size         -7.4775e-03  1.4410e-05  -518.89 < 2.2e-16 ***
blank_prob               -7.1307e-01  3.5368e-04 -2016.17 < 2.2e-16 ***
scavenge_prob             8.9190e-01  3.5407e-04  2518.99 < 2.2e-16 ***
overlap                   7.1101e-01  9.8157e-05  7243.60 < 2.2e-16 ***
mu                       -7.3591e-02  8.8265e-05  -833.75 < 2.2e-16 ***
size_preferenceTRUE      -3.3634e-01  1.4454e-04 -2327.00 < 2.2e-16 ***
flake_preferenceTRUE      4.0185e-01  1.4473e-04  2776.53 < 2.2e-16 ***
min_suitable_flake_size  -1.1991e-01  1.4414e-04  -831.93 < 2.2e-16 ***
min_suitable_nodule_size  2.6995e-03  2.8816e-05    93.68 < 2.2e-16 ***
strict_selectionTRUE     -1.2638e+00  1.5082e-04 -8379.16 < 2.2e-16 ***
(phi)                     6.3237e+00  8.3302e-04  7591.22 < 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

> 
> breg2 = betareg(s.total.RI ~ model_year + max_use_intensity  + max_artifact_carry + max_flake_size + max_nodules_size + blank_prob + scavenge_prob + overlap + mu + size_preference + flake_preference + min_suitable_flake_size + strict_selection , data=u_alldata)
> coeftest(breg2)

z test of coefficients:

                           Estimate  Std. Error  z value  Pr(>|z|)    
(Intercept)             -1.1178e+00  6.6239e-04 -1687.49 < 2.2e-16 ***
model_year              -3.5981e-06  8.4013e-10 -4282.81 < 2.2e-16 ***
max_use_intensity        1.0738e-02  9.6124e-06  1117.10 < 2.2e-16 ***
max_artifact_carry      -1.2648e-02  1.4415e-05  -877.45 < 2.2e-16 ***
max_flake_size           9.6752e-02  1.4412e-04   671.33 < 2.2e-16 ***
max_nodules_size        -7.4801e-03  1.4411e-05  -519.07 < 2.2e-16 ***
blank_prob              -7.1306e-01  3.5368e-04 -2016.12 < 2.2e-16 ***
scavenge_prob            8.9190e-01  3.5407e-04  2518.97 < 2.2e-16 ***
overlap                  7.1106e-01  9.8158e-05  7244.00 < 2.2e-16 ***
mu                      -7.3588e-02  8.8266e-05  -833.71 < 2.2e-16 ***
size_preferenceTRUE     -3.3646e-01  1.4454e-04 -2327.82 < 2.2e-16 ***
flake_preferenceTRUE     4.0191e-01  1.4473e-04  2776.92 < 2.2e-16 ***
min_suitable_flake_size -1.1992e-01  1.4414e-04  -831.95 < 2.2e-16 ***
strict_selectionTRUE    -1.2637e+00  1.5082e-04 -8378.44 < 2.2e-16 ***
(phi)                    6.3234e+00  8.3299e-04  7591.18 < 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

> 
> lrtest(breg1, breg2)
Likelihood ratio test

Model 1: s.total.RI ~ model_year + max_use_intensity + max_artifact_carry + 
    max_flake_size + max_nodules_size + blank_prob + scavenge_prob + 
    overlap + mu + size_preference + flake_preference + min_suitable_flake_size + 
    min_suitable_nodule_size + strict_selection
Model 2: s.total.RI ~ model_year + max_use_intensity + max_artifact_carry + 
    max_flake_size + max_nodules_size + blank_prob + scavenge_prob + 
    overlap + mu + size_preference + flake_preference + min_suitable_flake_size + 
    strict_selection
  #Df    LogLik Df  Chisq Pr(>Chisq)    
1  16 417584811                         
2  15 417580399 -1 8824.8  < 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
