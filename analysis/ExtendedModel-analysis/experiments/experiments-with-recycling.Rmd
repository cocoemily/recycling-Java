---
title: "experiments-with-recycling"
author: "Emily Coco"
date: "9/24/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(naniar)
library(rpart)
library(rpart.plot)
library(data.table)
library(UpSetR)
library(rcompanion)
library(fitdistrplus)
theme_set(theme_minimal())

parameters = c("max_use_intensity", "max_artifact_carry", "max_flake_size","max_nodules_size", "blank_prob", "scavenge_prob", "overlap","mu", "size_preference", "flake_preference","min_suitable_flake_size", "min_suitable_nodule_size", "strict_selection")

outputs = c("num.scav.events","total.recycled", "num.deposits",	"total.encounters",	"total.discards",	"total.manu.events", "total.retouches", "total.CR",	"total.RI")


alldata = alldata %>% filter(size != "size") %>%
  mutate(total.RI = as.numeric(total.RI), 
         total.CR = as.numeric(total.CR), 
         num.scav.events = as.numeric(num.scav.events), 
         total.recycled = as.numeric(total.recycled), 
         num.deposits = as.numeric(num.deposits), 
         total.encounters = as.numeric(total.encounters), 
         total.discards = as.numeric(total.discards), 
         total.manu.events = as.numeric(total.manu.events), 
         total.retouches = as.numeric(total.retouches))


```

## What are the distributions of the output metrics?

```{r checking-assumptions}
plotNormalHistogram(alldata$total.RI)
descdist(alldata$total.RI, discrete=F, boot=100)

plotNormalHistogram(alldata$total.CR)
descdist(alldata$total.CR, discrete=F, boot=100)

plotNormalHistogram(alldata$num.scav.events)
descdist(alldata$num.scav.events, discrete=F, boot=100)

plotNormalHistogram(alldata$total.recycled)
descdist(alldata$total.recycled, discrete=F, boot=100)

plotNormalHistogram(alldata$num.deposits)
descdist(alldata$num.deposits, discrete=F, boot=100)

plotNormalHistogram(alldata$total.encounters)
descdist(alldata$total.encounters, discrete=F, boot=100)

plotNormalHistogram(alldata$total.discards)
descdist(alldata$total.discards, discrete=F, boot=100)

plotNormalHistogram(alldata$total.manu.events)
descdist(alldata$total.manu.events, discrete=F, boot=100)

plotNormalHistogram(alldata$total.retouches)
descdist(alldata$total.retouches, discrete=F, boot=100)

```



## Where is there missing data for recycling intensity?
Because of the way that recycling intensity is calculated

```{r missing-recycling-intensity}
output_data = alldata %>% select(outputs)
gg_miss_var(output_data, show_pct = T)


missing_counts = alldata %>% group_by_at(parameters) %>%
  summarize(missing.RI = sum(is.na(total.RI))/n(), 
            missing.CR = sum(is.na(total.CR))/n(), 
            total.discards = sum(total.discards))

# lmdata = missing_counts %>% select(parameters, "missing.RI")
# m1 = lm(missing.RI ~ . , data = lmdata)
# 
# stargazer::stargazer(m1, type= "text")



```


