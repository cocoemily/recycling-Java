---
title: "parameter sensitivity"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
theme_set(theme_minimal())
#setwd("..")

#parameters = colnames(alldata[,c(1,4:9,11:17)])

#alldata = alldata %>% group_by_at(unlist(parameters)) %>%
#  mutate(exp = cur_group_id())

alldata = alldata %>% filter(!is.na(total.RI))

```

## Influence of parameters over time on recycling intensity at a landscape scale

```{r interaction}

# with(tavg, interaction.plot(model_year, size, total.RI))
# summary(aov(total.RI ~ size*model_year, data=tavg))

with(alldata, interaction.plot(model_year, max_use_intensity, total.RI))
summary(aov(total.RI ~ max_use_intensity*model_year, data=alldata))

with(alldata, interaction.plot(model_year, max_artifact_carry, total.RI))
summary(aov(total.RI ~ max_artifact_carry*model_year, data=alldata))

with(alldata, interaction.plot(model_year, max_flake_size, total.RI))
summary(aov(total.RI ~ max_flake_size*model_year, data=alldata))

with(alldata, interaction.plot(model_year, max_nodules_size, total.RI))
summary(aov(total.RI ~ max_nodules_size*model_year, data=alldata))

with(alldata, interaction.plot(model_year, blank_prob, total.RI))
summary(aov(total.RI ~ blank_prob*model_year, data=alldata))

with(alldata, interaction.plot(model_year, scavenge_prob, total.RI))
summary(aov(total.RI ~ scavenge_prob*model_year, data=alldata))

with(alldata, interaction.plot(model_year, overlap, total.RI)) 
summary(aov(total.RI ~ overlap*model_year, data=alldata))

with(alldata, interaction.plot(model_year, mu, total.RI))
summary(aov(total.RI ~ mu*model_year, data=alldata))

with(alldata, interaction.plot(model_year, size_preference, total.RI))
summary(aov(total.RI ~ size_preference*model_year, data=alldata))

with(alldata, interaction.plot(model_year, flake_preference, total.RI))
summary(aov(total.RI ~ flake_preference*model_year, data=alldata))

#actually flake size
with(alldata, interaction.plot(model_year, min_suitable_nodule_size, total.RI))
summary(aov(total.RI ~ min_suitable_nodule_size*model_year, data=alldata))

#actually nodule size
with(alldata, interaction.plot(model_year, min_suitable_flake_size, total.RI))
summary(aov(total.RI ~ min_suitable_flake_size*model_year, data=alldata))

with(alldata, interaction.plot(model_year, strict_selection, total.RI))
summary(aov(total.RI ~ strict_selection*model_year, data=alldata))


```

## Influence of interaction between parameters over time on recycling intensity at the landscape scale
```{r three way interaction}

#actually flake size
ggplot(alldata, aes(x = model_year, y = total.RI, color = as.factor(min_suitable_nodule_size))) + facet_grid(~size_preference, labeller=label_both) + geom_smooth(se=F)
summary(aov(total.RI ~ size_preference*min_suitable_nodule_size*model_year, data=alldata))

#actually flake size
ggplot(alldata, aes(x = model_year, y = total.RI, color = as.factor(min_suitable_nodule_size))) + facet_grid(max_flake_size~size_preference, labeller=label_both) + geom_smooth(se=F)
summary(aov(total.RI ~ size_preference*min_suitable_nodule_size*max_flake_size*model_year, data=alldata))

#actually nodule size
ggplot(alldata, aes(x = model_year, y = total.RI, color = as.factor(min_suitable_flake_size))) + facet_grid(~size_preference, labeller=label_both) + geom_smooth(se=F)
summary(aov(total.RI ~ size_preference*min_suitable_flake_size*model_year, data=alldata))

ggplot(alldata, aes(x = model_year, y = total.RI, color = as.factor(max_flake_size))) + facet_grid(~flake_preference, labeller=label_both) + geom_smooth(se=F)
summary(aov(total.RI ~ flake_preference*max_flake_size*model_year, data=alldata))

ggplot(alldata, aes(x = model_year, y = total.RI, color = as.factor(min_suitable_nodule_size))) + facet_grid(size_preference~flake_preference, labeller=label_both) + geom_smooth(se=F)
summary(aov(total.RI ~ size_preference*flake_preference*min_suitable_nodule_size*model_year, data=alldata))

ggplot(alldata, aes(x = model_year, y = total.RI, color = as.factor(strict_selection))) + facet_grid(size_preference~flake_preference, labeller=label_both) + geom_smooth(se=F)
summary(aov(total.RI ~ size_preference*flake_preference*strict_selection*model_year, data=alldata))

```
